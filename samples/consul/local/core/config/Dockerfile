ARG CONSUL_IMAGE_NAME
ARG CONSUL_VERSION

ARG CONSUL_TEMPLATE_IMAGE_NAME
ARG CONSUL_TEMPLATE_VERSION

ARG VAULT_IMAGE_NAME
ARG VAULT_VERSION

FROM ${CONSUL_TEMPLATE_IMAGE_NAME}:${CONSUL_TEMPLATE_VERSION} AS consul-template

FROM ${VAULT_IMAGE_NAME}:${VAULT_VERSION} AS vault

FROM ${CONSUL_IMAGE_NAME}:${CONSUL_VERSION}

COPY --from=consul-template /bin/consul-template /bin/
COPY --from=vault /bin/vault /bin/

WORKDIR /tmp/consul/

ADD ./*.sh ./
ADD ./*.hcl ./
